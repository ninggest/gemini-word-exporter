# Gemini Word Exporter - 开发规范与功能要求

## 1. 核心功能要求
- **格式一致性**：导出文档必须维持 Route A 风格，即单倍行距、首行缩进、两端对齐、使用“仿宋”字体。
- **页眉标准**：页眉应包含律所 Logo (左侧) 和格言 (右侧)，中间由制表位分隔，底部带有一条细横线。
- **页脚标准**：页脚应包含地址、电话及页码（居右）。
- **内容清洗**：必须过滤掉 Gemini 生成内容中常见的无关空行，尤其是单行回车，以保证排版紧凑。

## 2. 技术规格
- **Logo 加载**：为了保证生成过程的稳定性，Logo 必须存放于插件根目录下的 `assets/logo.png`。
- **渲染环境**：所有的 Word 生成逻辑都在 `offscreen.html` 环境中运行，通过 `offscreen.js` 驱动 `DocxGenerator` 类。
- **库依赖**：项目依赖 `docx.js` (版本 v4.0+)。

## 3. 注意事项
- **资源变动**：任何静态资源（如 `logo.png`）的增删改，都需要用户在 `chrome://extensions` 页面手动点击“刷新”插件才能在离线页面生效。
- **错误处理**：如果 `logo.png` 缺失，生成器应具备降级方案（如显示文本占位符），而非报错导致整个导出失败。
- **字体支持**：默认使用“仿宋”字体。如果目标系统未安装该字体，Word 会自动映射到备选字体，但代码中应明确指定。

## 4. 开发流程
- **修改生成逻辑**：主要修改 `background/docx-generator.js`。
- **修改数据流**：主要修改 `background/offscreen.js` 或 `background/service-worker.js`。
- **代码提交**：保持原子性提交，确保 README 和版本号同步更新。
